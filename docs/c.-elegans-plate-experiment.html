<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 C. elegans plate experiment | Portfolio Kjettil Evers</title>
  <meta name="description" content="4 C. elegans plate experiment | Portfolio Kjettil Evers" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="4 C. elegans plate experiment | Portfolio Kjettil Evers" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 C. elegans plate experiment | Portfolio Kjettil Evers" />
  
  
  

<meta name="author" content="Kjettil Evers" />


<meta name="date" content="2023-05-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="looking-ahead.html"/>
<link rel="next" href="open-peer-review.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My portfolio using bookdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welkom to my portfolio</a></li>
<li class="chapter" data-level="2" data-path="my-resume.html"><a href="my-resume.html"><i class="fa fa-check"></i><b>2</b> My resume</a></li>
<li class="chapter" data-level="3" data-path="looking-ahead.html"><a href="looking-ahead.html"><i class="fa fa-check"></i><b>3</b> looking ahead</a>
<ul>
<li class="chapter" data-level="3.1" data-path="looking-ahead.html"><a href="looking-ahead.html#planning"><i class="fa fa-check"></i><b>3.1</b> planning</a></li>
<li class="chapter" data-level="3.2" data-path="looking-ahead.html"><a href="looking-ahead.html#final-result"><i class="fa fa-check"></i><b>3.2</b> final result</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="c.-elegans-plate-experiment.html"><a href="c.-elegans-plate-experiment.html"><i class="fa fa-check"></i><b>4</b> C. elegans plate experiment</a></li>
<li class="chapter" data-level="5" data-path="open-peer-review.html"><a href="open-peer-review.html"><i class="fa fa-check"></i><b>5</b> Open Peer Review</a>
<ul>
<li class="chapter" data-level="5.1" data-path="open-peer-review.html"><a href="open-peer-review.html#part-1"><i class="fa fa-check"></i><b>5.1</b> part 1</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="open-peer-review.html"><a href="open-peer-review.html#extra-information-about-the-study"><i class="fa fa-check"></i><b>5.1.1</b> extra information about the study</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="open-peer-review.html"><a href="open-peer-review.html#part-2"><i class="fa fa-check"></i><b>5.2</b> Part 2</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="example-guerrilla-analytics-structure.html"><a href="example-guerrilla-analytics-structure.html"><i class="fa fa-check"></i><b>6</b> example guerrilla analytics structure</a></li>
<li class="chapter" data-level="7" data-path="rmarkdown-parameterization.html"><a href="rmarkdown-parameterization.html"><i class="fa fa-check"></i><b>7</b> RMarkdown parameterization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rmarkdown-parameterization.html"><a href="rmarkdown-parameterization.html#preview-parameterized-rmarkdown-covid-cases-and-deaths"><i class="fa fa-check"></i><b>7.1</b> preview parameterized Rmarkdown covid cases and deaths</a></li>
<li class="chapter" data-level="7.2" data-path="rmarkdown-parameterization.html"><a href="rmarkdown-parameterization.html#testing-parameters"><i class="fa fa-check"></i><b>7.2</b> testing parameters</a></li>
<li class="chapter" data-level="7.3" data-path="rmarkdown-parameterization.html"><a href="rmarkdown-parameterization.html#results"><i class="fa fa-check"></i><b>7.3</b> results</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="relational-databases.html"><a href="relational-databases.html"><i class="fa fa-check"></i><b>8</b> relational databases</a>
<ul>
<li class="chapter" data-level="8.1" data-path="relational-databases.html"><a href="relational-databases.html#the-data"><i class="fa fa-check"></i><b>8.1</b> The data</a></li>
<li class="chapter" data-level="8.2" data-path="relational-databases.html"><a href="relational-databases.html#inspecting-merged-data"><i class="fa fa-check"></i><b>8.2</b> inspecting merged data</a></li>
<li class="chapter" data-level="8.3" data-path="relational-databases.html"><a href="relational-databases.html#visualization"><i class="fa fa-check"></i><b>8.3</b> visualization</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="citations-using-zotero.html"><a href="citations-using-zotero.html"><i class="fa fa-check"></i><b>9</b> Citations using Zotero</a>
<ul>
<li class="chapter" data-level="9.1" data-path="citations-using-zotero.html"><a href="citations-using-zotero.html#introductie"><i class="fa fa-check"></i><b>9.1</b> Introductie</a></li>
<li class="chapter" data-level="9.2" data-path="citations-using-zotero.html"><a href="citations-using-zotero.html#referenties"><i class="fa fa-check"></i><b>9.2</b> referenties</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio Kjettil Evers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c.-elegans-plate-experiment" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> C. elegans plate experiment<a href="c.-elegans-plate-experiment.html#c.-elegans-plate-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this experiment we will create a dosis response curve from de data provided by J. Louter (INT/ILC). in the experiment adult C.elegans nematodes were exposed to varying concentrations of different compounds. after incubation de number of offspringes where counted. The variables RawData (the outcome - number of offspring counted as an integer value, after incubation time), compName (the generic name of the compound/chemical), the compConcentration (the concentration of the compound), and the expType are the most important variables in this dataset.</p>
<p>The first step is to inspect the excel file to see if something stands out. After looking in the excel file I didn’t find anything in particular, so I loaded in the excel file with the following code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="c.-elegans-plate-experiment.html#cb2-1" aria-hidden="true" tabindex="-1"></a>CE_LIQ_FLOW<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb2-2"><a href="c.-elegans-plate-experiment.html#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;data&quot;</span>, </span>
<span id="cb2-3"><a href="c.-elegans-plate-experiment.html#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;opdracht1&quot;</span>,</span>
<span id="cb2-4"><a href="c.-elegans-plate-experiment.html#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;CE.LIQ.FLOW.062_Tidydata.xlsx&quot;</span>))</span></code></pre></div>
<p>After loading the excel file the first step is to check the datatypes of each columns.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="c.-elegans-plate-experiment.html#cb3-1" aria-hidden="true" tabindex="-1"></a>CE_LIQ_FLOW</span></code></pre></div>
<pre><code>## # A tibble: 360 × 34
##    plateRow plateColumn vialNr dropCode expType    expReplicate expName        
##    &lt;lgl&gt;    &lt;lgl&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;          
##  1 NA       NA               1 a        experiment            3 CE.LIQ.FLOW.062
##  2 NA       NA               1 b        experiment            3 CE.LIQ.FLOW.062
##  3 NA       NA               1 c        experiment            3 CE.LIQ.FLOW.062
##  4 NA       NA               1 d        experiment            3 CE.LIQ.FLOW.062
##  5 NA       NA               1 e        experiment            3 CE.LIQ.FLOW.062
##  6 NA       NA               2 a        experiment            3 CE.LIQ.FLOW.062
##  7 NA       NA               2 b        experiment            3 CE.LIQ.FLOW.062
##  8 NA       NA               2 c        experiment            3 CE.LIQ.FLOW.062
##  9 NA       NA               2 d        experiment            3 CE.LIQ.FLOW.062
## 10 NA       NA               2 e        experiment            3 CE.LIQ.FLOW.062
## # ℹ 350 more rows
## # ℹ 27 more variables: expDate &lt;dttm&gt;, expResearcher &lt;chr&gt;, expTime &lt;dbl&gt;,
## #   expUnit &lt;chr&gt;, expVolumeCounted &lt;dbl&gt;, RawData &lt;dbl&gt;, compCASRN &lt;chr&gt;,
## #   compName &lt;chr&gt;, compConcentration &lt;chr&gt;, compUnit &lt;chr&gt;,
## #   compDelivery &lt;chr&gt;, compVehicle &lt;chr&gt;, elegansStrain &lt;chr&gt;,
## #   elegansInput &lt;dbl&gt;, bacterialStrain &lt;chr&gt;, bacterialTreatment &lt;chr&gt;,
## #   bacterialOD600 &lt;dbl&gt;, bacterialConcX &lt;dbl&gt;, bacterialVolume &lt;dbl&gt;, …</code></pre>
<p>Here you can see that the compConcentration is out of order. compConcentration is assigned to character data and should be numeric.</p>
<p>this can be easily fixed by the follwing code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="c.-elegans-plate-experiment.html#cb5-1" aria-hidden="true" tabindex="-1"></a>CE_LIQ_FLOW<span class="ot">&lt;-</span> CE_LIQ_FLOW <span class="sc">%&gt;%</span> <span class="fu">convert</span>(<span class="fu">dbl</span>(compConcentration))</span></code></pre></div>
<p>The next step is to display the data using a scatterplot. the goal is to show de different compounds and the varying concentrations. I added the compConcentration on the x-axis and the DataRaw counts on the Y-axis. I assigned a colour to each level in compName and a shape to each level in expType. this way the data would be easy to distinguish from each other.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="c.-elegans-plate-experiment.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> CE_LIQ_FLOW, <span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> RawData)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="c.-elegans-plate-experiment.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> compName, </span>
<span id="cb6-3"><a href="c.-elegans-plate-experiment.html#cb6-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> expType),</span>
<span id="cb6-4"><a href="c.-elegans-plate-experiment.html#cb6-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb6-5"><a href="c.-elegans-plate-experiment.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dose-respons curve C.elegans&quot;</span>,</span>
<span id="cb6-6"><a href="c.-elegans-plate-experiment.html#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;C.elegans data from J. Louter (INT/ILC)&quot;</span>,</span>
<span id="cb6-7"><a href="c.-elegans-plate-experiment.html#cb6-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;number of offspring counted&quot;</span>,</span>
<span id="cb6-8"><a href="c.-elegans-plate-experiment.html#cb6-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;compound concentration&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="c.-elegans-plate-experiment.html#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdown_portfolio_files/figure-html/eerste%20ggplot-1.png" width="672" />
As you can see in the plot above the data isn’t showing correctly. this is because the X-axis is not correctly ordered. it goes from 0 to 20 but the compound concentrations are mostly way lower than 5. because of this the data in the graph is not shown correctly.</p>
<p>To fix this issue i used the log10 of the compound concentration to normalize the data and get a clear graph. I also added the jitter function so that the data point dont overlap.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="c.-elegans-plate-experiment.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> CE_LIQ_FLOW, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration), <span class="at">y =</span> RawData)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="c.-elegans-plate-experiment.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> compName, </span>
<span id="cb7-3"><a href="c.-elegans-plate-experiment.html#cb7-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> expType),</span>
<span id="cb7-4"><a href="c.-elegans-plate-experiment.html#cb7-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fu">log10</span>(<span class="fl">1.3</span>),</span>
<span id="cb7-5"><a href="c.-elegans-plate-experiment.html#cb7-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="c.-elegans-plate-experiment.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span> (<span class="at">xlim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="c.-elegans-plate-experiment.html#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dose-respons curve C.elegans&quot;</span>,</span>
<span id="cb7-8"><a href="c.-elegans-plate-experiment.html#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;C.elegans data from J. Louter (INT/ILC)&quot;</span>,</span>
<span id="cb7-9"><a href="c.-elegans-plate-experiment.html#cb7-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;number of offspring counted&quot;</span>,</span>
<span id="cb7-10"><a href="c.-elegans-plate-experiment.html#cb7-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;log10(compound concentration)&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="c.-elegans-plate-experiment.html#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdown_portfolio_files/figure-html/ggplot-1.png" width="672" /></p>
<p>As you can see the data is much clearer now. However I found it usefull to add a line in the graph to easily show the dosis respons curve of the different compounds.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="c.-elegans-plate-experiment.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## with line</span></span>
<span id="cb8-2"><a href="c.-elegans-plate-experiment.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> CE_LIQ_FLOW, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration), <span class="at">y =</span> RawData, <span class="at">color =</span> compName, </span>
<span id="cb8-3"><a href="c.-elegans-plate-experiment.html#cb8-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> expType)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="c.-elegans-plate-experiment.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb8-5"><a href="c.-elegans-plate-experiment.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fu">log10</span>(<span class="fl">1.3</span>),</span>
<span id="cb8-6"><a href="c.-elegans-plate-experiment.html#cb8-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb8-7"><a href="c.-elegans-plate-experiment.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span> (<span class="at">xlim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb8-8"><a href="c.-elegans-plate-experiment.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dose-respons curve C.elegans&quot;</span>,</span>
<span id="cb8-9"><a href="c.-elegans-plate-experiment.html#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;C.elegans data from J. Louter (INT/ILC)&quot;</span>,</span>
<span id="cb8-10"><a href="c.-elegans-plate-experiment.html#cb8-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;number of offspring counted&quot;</span>,</span>
<span id="cb8-11"><a href="c.-elegans-plate-experiment.html#cb8-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;log10(compound concentration)&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-12"><a href="c.-elegans-plate-experiment.html#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdown_portfolio_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The positive control for this experiments is ethanol and The negative control for this experiment is S-medium.</p>
<p>After visualization the next step would be t analyze the data to see if there is indeed an effect of different concentrations on offspring count and whether the different compounds have a different curve (IC50). I would analyse the data with the following steps:</p>
<p>The first step would be to check normality. This is done by an Shapiro-Wilk test. After that Check the variances in the groups. This is done by the Levene’s test. The next step is to do an T-test. In this case i would do an unpaired onesided t-test. this is because the experiment is looking for the IC50 wich means that we assume that de compounds have an
inhibitory effect on C.elegans so one sided.</p>
<p>For the t-test I would compare each compound separately to the negative controle. By doing this we can determine if there is indeed a significant difference</p>
<p>Add last I normalized the data in such a way that the mean value of the negative control (controlNegative) is exactly equal to 1 and all other values are axpressed as an fraction thereof.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="c.-elegans-plate-experiment.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for negative control</span></span>
<span id="cb9-2"><a href="c.-elegans-plate-experiment.html#cb9-2" aria-hidden="true" tabindex="-1"></a>CE_LIQ_FLOW_neg<span class="ot">&lt;-</span> CE_LIQ_FLOW <span class="sc">%&gt;%</span> <span class="fu">filter</span>(expType <span class="sc">==</span> <span class="st">&quot;controlNegative&quot;</span> )</span>
<span id="cb9-3"><a href="c.-elegans-plate-experiment.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="c.-elegans-plate-experiment.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># determine average negative control</span></span>
<span id="cb9-5"><a href="c.-elegans-plate-experiment.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(CE_LIQ_FLOW_neg<span class="sc">$</span>RawData)</span></code></pre></div>
<pre><code>## [1] 85.9</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="c.-elegans-plate-experiment.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#group and summerize</span></span>
<span id="cb11-2"><a href="c.-elegans-plate-experiment.html#cb11-2" aria-hidden="true" tabindex="-1"></a>sum_CE_LIQ_FLOW<span class="ot">&lt;-</span> CE_LIQ_FLOW <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(expType, compName, compConcentration ) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(RawData, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb11-3"><a href="c.-elegans-plate-experiment.html#cb11-3" aria-hidden="true" tabindex="-1"></a>sum_CE_LIQ_FLOW</span></code></pre></div>
<pre><code>## # A tibble: 22 × 4
## # Groups:   expType, compName
## #   [6]
##    expType         compName                   compConcentration  mean
##    &lt;chr&gt;           &lt;chr&gt;                                  &lt;dbl&gt; &lt;dbl&gt;
##  1 controlNegative S-medium                           0          85.9
##  2 controlPositive Ethanol                            1.5        49.4
##  3 controlVehicleA Ethanol                            0.5        91.8
##  4 experiment      2,6-diisopropylnaphthalene         0.0000499  89.3
##  5 experiment      2,6-diisopropylnaphthalene         0.000499   83.1
##  6 experiment      2,6-diisopropylnaphthalene         0.00499    75.1
##  7 experiment      2,6-diisopropylnaphthalene         0.0499     59  
##  8 experiment      2,6-diisopropylnaphthalene         0.499      43.3
##  9 experiment      2,6-diisopropylnaphthalene         4.99       40.3
## 10 experiment      decane                             0.0000499  89.8
## # ℹ 12 more rows</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="c.-elegans-plate-experiment.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data and divide y-axis mean by avarage negative controle</span></span>
<span id="cb13-2"><a href="c.-elegans-plate-experiment.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sum_CE_LIQ_FLOW, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration), <span class="at">y =</span> (mean<span class="sc">/</span><span class="fl">85.9</span>))) <span class="sc">+</span></span>
<span id="cb13-3"><a href="c.-elegans-plate-experiment.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> compName, </span>
<span id="cb13-4"><a href="c.-elegans-plate-experiment.html#cb13-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> expType),</span>
<span id="cb13-5"><a href="c.-elegans-plate-experiment.html#cb13-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fu">log10</span>(<span class="fl">1.3</span>),</span>
<span id="cb13-6"><a href="c.-elegans-plate-experiment.html#cb13-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb13-7"><a href="c.-elegans-plate-experiment.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span> (<span class="at">xlim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>), <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.2</span>))<span class="sc">+</span></span>
<span id="cb13-8"><a href="c.-elegans-plate-experiment.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dose-respons curve C.elegans&quot;</span>,</span>
<span id="cb13-9"><a href="c.-elegans-plate-experiment.html#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;C.elegans data from J. Louter (INT/ILC)&quot;</span>,</span>
<span id="cb13-10"><a href="c.-elegans-plate-experiment.html#cb13-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;average offsprings as fraction </span><span class="sc">\n</span><span class="st">of negative control&quot;</span>,</span>
<span id="cb13-11"><a href="c.-elegans-plate-experiment.html#cb13-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;log10(compound concentration)&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="c.-elegans-plate-experiment.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdown_portfolio_files/figure-html/ggplot%20normalize-1.png" width="672" /></p>
<p>again I made the same plot with a line to easily show the dosis respons curve of the different compounds.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="c.-elegans-plate-experiment.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## met line</span></span>
<span id="cb14-2"><a href="c.-elegans-plate-experiment.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sum_CE_LIQ_FLOW, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration), <span class="at">y =</span> (mean<span class="sc">/</span><span class="fl">85.9</span>), <span class="at">color =</span> compName, </span>
<span id="cb14-3"><a href="c.-elegans-plate-experiment.html#cb14-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> expType)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="c.-elegans-plate-experiment.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb14-5"><a href="c.-elegans-plate-experiment.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fu">log10</span>(<span class="fl">1.3</span>),</span>
<span id="cb14-6"><a href="c.-elegans-plate-experiment.html#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb14-7"><a href="c.-elegans-plate-experiment.html#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span> (<span class="at">xlim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>), <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.2</span>))<span class="sc">+</span></span>
<span id="cb14-8"><a href="c.-elegans-plate-experiment.html#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dose-respons curve C.elegans&quot;</span>,</span>
<span id="cb14-9"><a href="c.-elegans-plate-experiment.html#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;C.elegans data from J. Louter (INT/ILC)&quot;</span>,</span>
<span id="cb14-10"><a href="c.-elegans-plate-experiment.html#cb14-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;average offsprings as fraction </span><span class="sc">\n</span><span class="st">of negative control&quot;</span>,</span>
<span id="cb14-11"><a href="c.-elegans-plate-experiment.html#cb14-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;log10(compound concentration)&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-12"><a href="c.-elegans-plate-experiment.html#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdown_portfolio_files/figure-html/ggplot%20normalize%20with%20line-1.png" width="672" /></p>
<p>By normalizing against the negative control, it is easy to see whether a compound has an effect on the amount of c.elegans. In addition, this is useful because the negative control is “normal” and this should have no effect on the c.elegans. Therefor the negative controle is equal to one.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="looking-ahead.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="open-peer-review.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/003_portfolio_elegans.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown_portfolio.pdf", "bookdown_portfolio.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
